# Nessun alias necessario: Apache servir√† i file direttamente dalla root
# Se vuoi, puoi aggiungere un Directory block per sicurezza
files:
  "/etc/httpd/conf.d/static-files.conf":
    mode: "644"
    owner: root
    group: root
    content: |
      <Directory "/var/app/current/">
          Options Indexes FollowSymLinks
          AllowOverride None
          Require all granted
      </Directory>

# Copia tutti i file nella root del deploy
container_commands:
  01_copy_static_files:
    command: |
      echo "Look for Loader.io token files"
      ls -al /var/app/staging
      SRC_DIR="/var/app/staging/.ebextensions/files"
      DEST_DIR="/var/app/current"
      if [ -d "$SRC_DIR" ]; then
        FILES=("$SRC_DIR"/*)
        if [ -e "${FILES[0]}" ]; then
          for f in "${FILES[@]}"; do
            echo "Copia $f in $DEST_DIR/"
            cp "$f" "$DEST_DIR/"
          done
        else
          echo "Nessun file trovato in $SRC_DIR"
        fi
      else
        echo "Directory $SRC_DIR non esiste, salto copia"
      fi
